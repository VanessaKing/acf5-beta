var acf_field_group={};!function(e){function t(e){var t=e.find('.acf-field[data-name="ui"] input:checked').val(),i=e.find('.acf-field[data-name="multiple"] input:checked').val();"1"==i?e.find('.acf-field[data-name="sortable"]').show():e.find('.acf-field[data-name="sortable"]').hide(),"1"==t?e.find('.acf-field[data-name="search"], .acf-field[data-name="ajax"]').show():e.find('.acf-field[data-name="search"], .acf-field[data-name="ajax"], .acf-field[data-name="sortable"]').hide()}function i(e){var t=e.find('.acf-field[data-name="multiple"] input:checked').val();"1"==t?e.find('.acf-field[data-name="sortable"]').show():e.find('.acf-field[data-name="sortable"]').hide()}function a(t){e.each(["display_format","return_format"],function(e,i){var a=t.find('.acf-field[data-name="'+i+'"] input[type="radio"]:checked'),n=t.find('.acf-field[data-name="'+i+'"] input[type="text"]');"other"!=a.val()&&n.val(a.val())})}e(document).on("submit","#post",function(){var t=e("#titlewrap #title");return t.val()?void acf_field_group.fields.submit():(alert(acf.l10n.title),t.focus(),!1)}),e(document).on("click","#submit-delete",function(){var e=confirm(acf.l10n.move_to_trash);return e?void 0:!1}),acf.add_action("ready",function(){e("#submitdiv, #acf-field-group-fields, #acf-field-group-locations, #acf-field-group-options").addClass("acf-postbox"),e("#acf-field-group-fields").addClass("seamless"),e("#submitdiv #publish").attr("class","acf-button blue large"),e("#submitdiv a.submitdelete").attr("class","delete-field-group").attr("id","submit-delete"),acf.validation.active=0,acf_field_group.fields.init(),acf_field_group.location.init(),acf_field_group.conditional_logic.init(),acf_field_group.options.init()}),acf_field_group.fields={$el:null,init:function(){var t=this;this.$el=e("#acf-field-group-fields"),this.init_field_list(this.$el.find(".acf-field-list")),this.$el.on("click",".edit-field",function(i){i.preventDefault(),t.edit(e(this).closest(".field"))}),this.$el.on("click",".duplicate-field",function(i){i.preventDefault(),t.duplicate(e(this).closest(".field"))}),this.$el.on("click",".move-field",function(i){i.preventDefault(),t.move(e(this).closest(".field"))}),this.$el.on("click",".delete-field",function(i){i.preventDefault(),t.remove(e(this).closest(".field"))}),this.$el.on("click",".acf-add-field",function(i){i.preventDefault(),t.add(e(this).closest(".acf-field-list-wrap").children(".acf-field-list"))}),this.$el.on("change",'tr[data-name="type"] select',function(){t.change_type(e(this))}),this.$el.on("blur",'tr[data-name="label"] input',function(i){t.change_label(e(this).closest(".field"))}),this.$el.on("keyup",'tr[data-name="label"] input, tr[data-name="name"] input',function(i){t.render_field(e(this).closest(".field"))}),this.$el.on("change","input, textarea, select",function(i){t.save_field(e(this).closest(".field"))})},init_field_list:function(e){var t=this;e.sortable({connectWith:".acf-field-list",update:function(e,i){var a=i.item;t.render(),acf.do_action("sortstop",a)},handle:".acf-icon"})},get_field_meta:function(e,t){return e.find("> .acf-hidden > .input-"+t).val()},update_field_meta:function(t,i){e.each(i,function(e,i){t.find("> .acf-hidden > .input-"+e).val(i)})},save_field:function(e){this.update_field_meta(e,{changed:1})},render_field:function(e){var t=e.find('tr[data-name="label"]:first input').val(),i=e.find('tr[data-name="name"]:first input').val(),a=e.attr("data-type");e.find("> .field-info .li-field_label strong a").text(t),e.find("> .field-info .li-field_name").text(i),e.find("> .field-info .li-field_type").text(a)},edit:function(e){e.hasClass("open")?this.close_field(e):this.open_field(e)},open_field:function(e){return e.hasClass("open")?!1:(e.addClass("open"),acf.do_action("open",e),void e.children(".field-options").animate({height:"toggle"},250))},close_field:function(e){return e.hasClass("open")?(e.removeClass("open"),acf.do_action("close",e),void e.children(".field-options").animate({height:"toggle"},250)):!1},change_type:function(t){var i=t.closest("tbody"),a=i.closest(".field"),n=a.attr("data-type"),l=t.val();if(a.removeClass("field_type-"+n).addClass("field_type-"+l).attr("data-type",l),("tab"==l||"message"==l)&&i.find('tr[data-name="name"] input').val("").trigger("keyup"),i.children("tr[data-option]").hide().find("[name]").attr("disabled","true"),this.render_field(t.closest(".field")),i.children('tr[data-option="'+l+'"]').exists())i.children('tr[data-option="'+l+'"]').show().find("[name]").removeAttr("disabled"),acf.do_action("change",a);else{var d=e('<tr class="acf-field"><td class="acf-label"></td><td class="acf-input"><div class="acf-loading"></div></td></tr>');i.children('.acf-field[data-name="conditional_logic"]').before(d);var o={action:"acf/field_group/render_field_options",nonce:acf.o.nonce,post_id:acf.o.post_id,prefix:t.attr("name").replace("[type]",""),type:l};e.ajax({url:acf.o.ajaxurl,data:o,type:"post",dataType:"html",success:function(t){if(!t)return void d.remove();var i=e(t);d.replaceWith(i),acf.do_action("append",i),acf.do_action("change",a)}})}},add:function(e){var t=e.children('.field[data-key="acfcloneindex"]').clone();this.wipe_field(t),t.show(),e.children('.field[data-key="acfcloneindex"]').before(t),e.children(".no-fields-message").hide(),t.find(".field-options .tr-field-type:first select").trigger("change"),t.find('.field-options input[type="text"]').val(""),setTimeout(function(){t.find('.field_form input[type="text"]:first').focus()},251),this.render(),acf.do_action("append",t),this.edit(t)},remove:function(t){var i=this,a=t.attr("data-ID");a&&e("#input-delete-fields").val(e("#input-delete-fields").val()+"|"+a);var n=t.closest(".acf-field-list");t.css({height:t.height(),width:t.width(),position:"absolute"}),t.wrap('<div class="temp-field-wrap" style="height:'+t.height()+'px"></div>'),t.animate({opacity:0},250);var l=0,d=!1;1==n.children(".field").length&&(d=n.children(".no-fields-message"),l=d.outerHeight()),t.parent(".temp-field-wrap").animate({height:l},250,function(){d&&d.show(),e(this).remove(),i.render()})},move:function(t){acf.open_popup({title:acf._e("move_field"),loading:!0,height:220});var i={action:"acf/field_group/move_field",nonce:acf.get("nonce"),field_id:this.get_field_meta(t,"ID")};e.ajax({url:acf.get("ajaxurl"),data:i,type:"post",dataType:"html",success:function(e){acf_field_group.fields.move_confirm(t,e)}})},move_confirm:function(t,i){acf.update_popup({content:i});var a={action:"acf/field_group/move_field",nonce:acf.get("nonce"),field_id:this.get_field_meta(t,"ID"),field_group_id:0};e("#acf-move-field-form").on("submit",function(){return a.field_group_id=e(this).find("select").val(),e.ajax({url:acf.get("ajaxurl"),data:a,type:"post",dataType:"html",success:function(e){acf.update_popup({content:e}),acf_field_group.fields.remove(t)}}),!1})},duplicate:function(t){t.find("select").each(function(){e(this).attr("data-val",e(this).val())});var i=t.clone(),a=t.closest(".acf-field-list");this.wipe_field(i),a.children('.field[data-key="acfcloneindex"]').before(i),i.find("select").each(function(){e(this).val(e(this).attr("data-val")).removeAttr("data-val")}),setTimeout(function(){i.find('.field_form input[type="text"]:first').focus()},251),this.render(),acf.do_action("append",i),t.hasClass("open")?this.close_field(t):this.open_field(i);var n=i.find('tr[data-name="label"]:first input'),l=i.find('tr[data-name="name"]:first input');n.val(n.val()+" ("+acf._e("copy")+")"),l.val(l.val()+"_"+acf._e("copy")),this.save_field(i),this.render_field(i)},wipe_field:function(t){var i=t.attr("data-id"),a=acf.get_uniqid("field_");t.attr("data-key",a),t.attr("data-id",a),this.update_field_meta(t,{ID:"",key:a}),t.find('[id*="'+i+'"]').each(function(){e(this).attr("id",e(this).attr("id").replace(i,a))}),t.find('[name*="'+i+'"]').each(function(){e(this).attr("name",e(this).attr("name").replace(i,a))})},render:function(){var t=this;this.$el.find(".acf-field-list").each(function(){var i=e(this).children(".field").not('[data-id="acfcloneindex"]');i.each(function(i){var a=t.get_field_meta(e(this),"menu_order");parseInt(a)!==i&&(t.update_field_meta(e(this),{menu_order:i}),e(this).find(".li-field_order:first .acf-icon").html(i+1))}),i.exists()||e(this).children(".no-fields-message").show()})},change_label:function(t){var i=t.find('tr[data-name="label"]:first input'),a=t.find('tr[data-name="name"]:first input'),n=t.attr("data-type");if("tab"==n||"message"==n)return void a.val("").trigger("change");if(""==a.val()){var l=i.val(),d={ä:"a",æ:"a",å:"a",ö:"o",ø:"o",é:"e",ë:"e",ü:"u",ó:"o",ő:"o",ú:"u",é:"e",á:"a",ű:"u",í:"i"," ":"_","'":"","\\?":""};e.each(d,function(e,t){var i=new RegExp(e,"g");l=l.replace(i,t)}),l=l.toLowerCase(),a.val(l).trigger("change")}this.render_field(t)},submit:function(){var t=this;this.$el.find(".field").each(function(){var i=t.get_field_meta(e(this),"changed"),a=t.get_field_meta(e(this),"ID");"1"!=i&&e(this).children(".field-options").find('[name^="acf_fields['+a+']"]').attr("disabled","disabled")})}},acf.add_filter("is_field_ready_for_js",function(e,t){return t.parents('.field[data-key="acfcloneindex"]').exists()&&(e=!1),e},99),acf_field_group.options={$el:null,init:function(){this.$el=e("#acf-field-group-options");var t=this.$el.find(".tr-hide-on-screen ul.acf-checkbox-list"),i=e('<li><label><input type="checkbox" value="" name="" >'+acf.l10n.hide_show_all+"</label></li>");0==t.find("input:not(:checked)").length&&i.find("input").attr("checked","checked"),i.on("change","input",function(){var i=e(this).is(":checked");t.find("input").attr("checked",i)}),t.prepend(i)}},acf_field_group.location={$el:null,init:function(){var t=this;t.$el=e("#acf-field-group-locations"),t.$el.on("click",".location-add-rule",function(i){i.preventDefault(),t.add_rule(e(this).closest("tr"))}),t.$el.on("click",".location-remove-rule",function(i){i.preventDefault(),t.remove_rule(e(this).closest("tr"))}),t.$el.on("click",".location-add-group",function(e){e.preventDefault(),t.add_group()}),t.$el.on("change",".param select",function(){var t=e(this).closest("tr"),i=t.attr("data-id"),a=t.closest(".location-group"),n=a.attr("data-id"),l=e('<div class="acf-loading"></div>');t.find("td.value").html(l),e.ajax({url:acf.get("ajaxurl"),data:acf.prepare_for_ajax({action:"acf/field_group/render_location_value",rule_id:i,group_id:n,value:"",param:e(this).val()}),type:"post",dataType:"html",success:function(e){l.replaceWith(e)}})})},add_rule:function(t){var i=t.clone(),a=i.attr("data-id"),n=acf.get_uniqid();return i.find("[name]").each(function(){e(this).attr("name",e(this).attr("name").replace(a,n)),e(this).attr("id",e(this).attr("id").replace(a,n))}),i.attr("data-id",n),t.after(i),!1},remove_rule:function(e){var t=e.siblings("tr").length;0==t?this.remove_group(e.closest(".location-group")):e.remove()},add_group:function(){var t=this.$el.find(".location-group:last"),i=t.clone(),a=i.attr("data-id"),n=acf.get_uniqid();i.find("[name]").each(function(){e(this).attr("name",e(this).attr("name").replace(a,n)),e(this).attr("id",e(this).attr("id").replace(a,n))}),i.attr("data-id",n),i.find("h4").text(acf.l10n.or),i.find("tr:not(:first)").remove(),t.after(i)},remove_group:function(e){e.remove()}},acf_field_group.conditional_logic={$el:null,init:function(){this.$el=acf_field_group.fields.$el;var t=this;acf.add_action("open",function(e){t.render(e)}),t.$el.on("change",'tr[data-name="label"] input',function(){t.$el.find(".field.open").each(function(){t.render(e(this))})}),t.$el.on("change",'tr[data-name="conditional_logic"] input[type="radio"]',function(i){i.preventDefault(),t.change_toggle(e(this))}),t.$el.on("change",".conditional-logic-field",function(i){i.preventDefault(),t.change_trigger(e(this))}),t.$el.on("click",".location-add-rule",function(i){i.preventDefault(),t.add_rule(e(this).closest("tr"))}),t.$el.on("click",".location-remove-rule",function(i){i.preventDefault(),t.remove_rule(e(this).closest("tr"))}),t.$el.on("click",".location-add-group",function(i){i.preventDefault(),t.add_group(e(this).closest(".location-groups"))})},update_select:function(t,i){var a=t.val();t.html(""),e.each(i,function(i,a){var n=t;a.group&&(n=t.find('optgroup[label="'+a.group+'"]'),n.exists()||(n=e('<optgroup label="'+a.group+'"></optgroup>'),t.append(n))),n.append('<option value="'+a.value+'">'+a.label+"</option>")}),t.find('option[value="'+a+'"]').exists()&&t.val(a)},render:function(t){var i=this,a=[],n=t.attr("data-key"),l=t.parents(".acf-field-list"),d=t.find('> .field-options > table > tbody > tr[data-name="conditional_logic"]');console.log(d),e.each(l,function(t){var i=0==t?acf.l10n.sibling_fields:acf.l10n.parent_fields;e(this).children(".field").each(function(){var t=e(this),l=t.attr("data-key"),d=t.attr("data-type"),o=t.find('> .field-options > table > tbody > tr[data-name="label"] input').val();"acfcloneindex"!=l&&l!=n&&("select"==d||"checkbox"==d||"true_false"==d||"radio"==d)&&a.push({value:l,label:o,group:i})})}),0==a.length&&a.push({value:"null",label:acf.l10n.no_fields}),d.find(".conditional-logic-field").each(function(){i.update_select(e(this),a),i.change_trigger(e(this))})},change_toggle:function(e){var t=e.val(),i=e.closest(".acf-input");"1"==t?(i.find(".location-groups").show(),i.find(".location-groups").find("[name]").removeAttr("disabled")):(i.find(".location-groups").hide(),i.find(".location-groups").find("[name]").attr("disabled","disabled"))},change_trigger:function(t){var i=t.val(),a=this.$el.find('.field[data-key="'+i+'"]'),n=a.attr("data-type"),l=t.closest("tr").find(".conditional-logic-value"),d=[];if("true_false"==n)d=[{value:1,label:acf.l10n.checked}];else if("select"==n||"checkbox"==n||"radio"==n){var o=a.find('tr[data-name="choices"] textarea').val().split("\n");if(o)for(var c=0;c<o.length;c++){var f=o[c].split(":"),r=f[0];f[1]&&(r=f[1]),d.push({value:e.trim(f[0]),label:e.trim(r)})}}this.update_select(l,d)},add_rule:function(t){var i=t.clone(),a=i.attr("data-id"),n=acf.get_uniqid();return i.find("[name]").each(function(){e(this).attr("name",e(this).attr("name").replace(a,n)),e(this).attr("id",e(this).attr("id").replace(a,n))}),i.attr("data-id",n),t.after(i),!1},remove_rule:function(e){var t=e.siblings("tr").length;0==t?this.remove_group(e.closest(".location-group")):e.remove()},add_group:function(t){var i=t.find(".location-group:last"),a=i.clone(),n=a.attr("data-id"),l=acf.get_uniqid();a.find("[name]").each(function(){e(this).attr("name",e(this).attr("name").replace(n,l)),e(this).attr("id",e(this).attr("id").replace(n,l))}),a.attr("data-id",l),a.find("h4").text(acf.l10n.or),a.find("tr:not(:first)").remove(),i.after(a)},remove_group:function(e){e.remove()}},acf.add_action("open",function(e){"select"==e.attr("data-type")&&t(e)}),e(document).on("change",'.field[data-type="select"] input[type="radio"]',function(){t(e(this).closest(".field"))}),acf.add_action("open change",function(e){"post_object"==e.attr("data-type")&&i(e)}),e(document).on("change",'.field[data-type="post_object"] input[type="radio"]',function(){i(e(this).closest(".field"))}),e(document).on("change",".radio-option-other_choice input",function(){var t=e(this),i=t.closest("td");t.is(":checked")?i.find(".radio-option-save_other_choice").show():(i.find(".radio-option-save_other_choice").hide(),i.find(".radio-option-save_other_choice input").removeAttr("checked"))}),acf.add_action("open change",function(e){"google_map"==e.attr("data-type")&&($lat=e.find('tr[data-name="center_lat"]'),$lng=e.find('tr[data-name="center_lng"]'),tmpl='<ul class="acf-hl"><li style="width:48%;">$lat</li><li style="width:48%; margin-left:4%;">$lng</li></ul>',$lng.exists()&&(tmpl=tmpl.replace("$lat",$lat.find(".acf-input").html()),tmpl=tmpl.replace("$lng",$lng.find(".acf-input").html()),$lat.find(".acf-input").html(tmpl),$lng.remove()))}),acf.add_action("open change",function(e){"oembed"==e.attr("data-type")&&($width=e.find('tr[data-name="width"]'),$height=e.find('tr[data-name="height"]'),tmpl='<ul class="acf-hl"><li style="width:48%;">$width</li><li style="width:48%; margin-left:4%;">$height</li></ul>',$width.exists()&&(tmpl=tmpl.replace("$width",$width.find(".acf-input").html()),tmpl=tmpl.replace("$height",$height.find(".acf-input").html()),$width.find(".acf-input").html(tmpl),$height.remove()))}),acf.add_action("open change",function(e){"date_picker"==e.attr("data-type")&&a(e)}),e(document).on("change",'.field[data-type="date_picker"] input[type="radio"]',function(){a(e(this).closest(".field"))})}(jQuery);