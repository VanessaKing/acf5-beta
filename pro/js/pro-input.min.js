(function(e){acf.fields.repeater={$field:null,$el:null,o:{},set:function(t){e.extend(this,t);this.o=acf.helpers.get_atts(this.$el);this.$field=this.$el.closest(".acf-field");this.o.row_count=this.$el.find("> .acf-table > tbody > tr").length-1;return this},init:function(){var e=this,t=this.$el;this.o.max_rows>1&&this.$el.find("> .acf-table > tbody").unbind("sortable").sortable({items:"> tr",handle:"> td.order",forceHelperSize:!0,forcePlaceholderSize:!0,scroll:!0,start:function(e,t){acf.trigger("sortstart",[t.item]);t.placeholder.html('<td colspan="'+t.item.children("td").length+'"></td>')},stop:function(n,r){acf.trigger("sortstop",[r.item]);e.set({$el:t}).render()}});this.render()},render:function(){this.$el.find("> .acf-table > tbody > tr").each(function(t){e(this).children("td.order").html(t+1)});this.o.row_count==0?this.$el.addClass("empty"):this.$el.removeClass("empty");if(this.o.row_count>=this.o.max_rows){this.$el.addClass("disabled");this.$el.find("> .acf-hl .acf-button").addClass("disabled")}else{this.$el.removeClass("disabled");this.$el.find("> .acf-hl .acf-button").removeClass("disabled")}},add:function(e){if(this.o.row_count>=this.o.max_rows){alert(acf.l10n.repeater.max.replace("{max}",this.o.max_rows));return!1}var t=acf.helpers.uniqid(),n=this.$el.find('> table > tbody > tr[data-id="acfcloneindex"]').clone();n.attr("data-id",t);n.html(n.html().replace(/(=["]*[\w-\[\]]*?)(acfcloneindex)/g,"$1"+t));e||(e=this.$el.find('> table > tbody > tr[data-id="acfcloneindex"]'));e.before(n);this.$el.closest("tr").trigger("mouseenter");this.render();acf.trigger("append",[n]);acf.validation.remove_error(this.$field)},remove:function(e){var t=this;if(this.o.row_count<=this.o.min_rows){alert(acf.l10n.repeater.min.replace("{min}",this.o.min_rows));return!1}acf.helpers.remove_tr(e,function(){e.closest(".acf-row").trigger("mouseenter");t.render()})}};acf.on("ready append",function(t,n){e(n).find(".acf-repeater").each(function(){acf.fields.repeater.set({$el:e(this)}).init()})});e(document).on("click",".acf-repeater .acf-repeater-add-row",function(t){t.preventDefault();var n=!1;e(this).attr("data-before")&&(n=e(this).closest(".acf-row"));acf.fields.repeater.set({$el:e(this).closest(".acf-repeater")}).add(n);e(this).blur()});e(document).on("click",".acf-repeater .acf-repeater-remove-row",function(t){t.preventDefault();acf.fields.repeater.set({$el:e(this).closest(".acf-repeater")}).remove(e(this).closest(".acf-row"));e(this).blur()});e(document).on("mouseenter",".acf-repeater tr.row",function(t){var n=e(this).find("> td.remove > a.acf-repeater-add-row"),r=n.parent().height()/2+9;n.css("margin-top","-"+r+"px")})})(jQuery);